###################### Filebeat Configuration Example #########################

# This file is an example configuration file highlighting only the most common
# options. The filebeat.reference.yml file from the same directory contains all the
# supported options with more comments. You can use it as a reference.
#
# You can find the full configuration reference here:
# https://www.elastic.co/guide/en/beats/filebeat/index.html

# For more available modules and options, please see the filebeat.reference.yml sample
# configuration file.

#=========================== Filebeat inputs =============================

filebeat.inputs:

# Each - is an input. Most options can be set at the input level, so
# you can use different inputs for various configurations.
# Below are the input specific configurations.

- type: log

  # Change to true to enable this input configuration.
  enabled: true

  # Paths that should be crawled and fetched. Glob based paths.
  paths: ["/opt/dynamite/zeek/logs/current/*.log", "/var/dynamite/suricata/log/suricata/eve.json"]

#============================= Filebeat modules ===============================

filebeat.config.modules:
  # Glob pattern for configuration loading
  path: ${path.config}/modules.d/*.yml

  # Set to true to enable config reloading
  reload.enabled: false

  # Period on which files under path should be checked for changes
  #reload.period: 10s


output.elasticsearch:
  enabled: false
  hosts:
  - localhost:9200
  password: admin
  username: admin
  ssl:
    verification_mode: none
output.kafka:
  enabled: false
  hosts:
  - localhost:9092
  password: null
  topic: dynamite_events
  username: null
output.logstash:
  bulk_max_size: 2048
  enabled: true
  hosts:
  - localhost:5044
  loadbalance: true
  pipelining: 2
output.redis:
  bulk_max_size: 2048
  db: 0
  enabled: false
  hosts:
  - localhost:6379
  index: dynamite_events
  loadbalance: true
  password: null
  worker: 1

#================================ Processors =====================================

# Configure processors to enhance or manipulate events generated by the beat.

setup.kibana:
  protocol: http
  host: "localhost:5601"

setup.template:
  enabled: false
  name: null
  pattern: filebeat-*

processors:
 - add_fields:
     fields: {"originating_agent_tag": "dynamite_agent"}


#================================ Logging =====================================

# Sets log level. The default log level is info.
# Available log levels are: error, warning, info, debug
#logging.level: debug

# At debug level, you can selectively enable logging only for some components.
# To enable all selectors use ["*"]. Examples of other selectors are "beat",
# "publish", "service".
#logging.selectors: ["*"]